<h1>Vulnerability Management with OpenVAS</h1>

 ### [YouTube Demonstration](https://youtu.be/7eJexJVCqJo)

<h2>Description</h2>
In this project, I setup a OpenVAS Vulnerability Management Scanner Virtual Machine in Azure. Then I develop a vulnerable Windows 10 Virtual Machine with outdated software and disabled security controls. Next I perform unauthenticated and credentialed vulnerability scans using OpenVAS. Then I remediate the identified vulnerabilities. 
<br />


<h2>Environments Used </h2>

- <b>Azure</b>

<h2>Walkthrough:</h2>

Before starting the project, I want to mention that I created a free Azure Account for my previous lab project. I will be using the same Azure account for this project.

<h4>Preparing Vulnerability Scanner</h4>

First I login to my Azure portal and go to Azure Marketplace: <br />
<img src="https://i.imgur.com/Pf3zuG6.png" height="80%" width="80%" alt="Searching for Marketplace"/><br /><br />

Then I search for OpenVAS and select "OpenVAS secured and supported by HOSSTED:<br />

<img src="https://i.imgur.com/k83C3za.png" height="80%" width="80%" alt="Search OpenVAS"/><br /><br />

Then I select the pre-set configuration settings and select "Dev/Test" for the workload environment and "General Purpose" for workload type. After the selection, I click on continue to create VM:<br />
<img src="https://i.imgur.com/2G59KwD.png" height="80%" width="80%" alt="Search OpenVAS"/><br />
<img src="https://i.imgur.com/pdkhJz7.png" height="80%" width="80%" alt="Search OpenVAS"/><br /><br />

In the "Create a virtual machine" page, I edit the following details:<br />
<b>Resource Group</b>: "Vulnerability-Management" -> <i>Created new resource group</i><br />
<b>Virtual Machine Name</b>: "OpenVAS"<br />
<b>Region</b>: "East US 2"<br />
<b>Authentication Type</b>: "Password"<br />
<b>Username</b>: "cybersuhanlab"<br />
<b>Password</b>: "<i>Created a password</i>"<br />
<b>Confirm Password</b>: "<i>Retyped the password</i>"<br /><br />

Other than the above options, I left everything else to defaults. Then I clicked "Next: Disks". <br />
<img src="https://i.imgur.com/xeGJ9Bs.png" height="80%" width="80%" alt="VM Config 1"/><br />
<img src="https://i.imgur.com/ZfVhqPf.png" height="80%" width="80%" alt="VM Config 2"/><br />

I leave the Disks settings, Networking settings, and Management to default settings. I move on to "Monitoring" configuration. I disabled the Boot diagnostics in the Monitoring configuration. <br />
<img src="https://i.imgur.com/YKl1qJ6.png" height="80%" width="80%" alt="VM Config Monitoring"/><br /><br />

Once the Validation has passed, I click on "Create" to create the Virtual Machine. <br />
<img src="https://i.imgur.com/NOjMBlE.png" height="80%" width="80%" alt="VM Config Monitoring"/><br /><br />

<h4>SSH into the Vulnerability Management Server</h4>

Once the deployment of the Virtual Machine has finished, I go to the OpenVAS machine page in Azure portal. I copy the Public IP Address of my OpenVAS Virtual Machine:<br />
<img src="https://i.imgur.com/Tk0uZoq.png" height="80%" width="80%" alt="VM IP Address"/><br /><br />

I SSH into my OpenVAS Virtual Machine using Powershell:<br />
<img src="https://i.imgur.com/bwmSsa7.png" height="80%" width="80%" alt="SSH into VM"/><br /><br />

I can see the link to the Web Portal in my Powershell SSH terminal. I open the portal URL in my browser. The default username is "admin: and the password is also "admin". After logging in, I can see the dashboard. I make sure the first thing I do after logging in to the dashboard is change the password to something secure. :<br />
<img src="https://i.imgur.com/F0NZL8c.png" height="80%" width="80%" alt="Web Portal URL"/><br />
<img src="https://i.imgur.com/gU7RgBp.png" height="80%" width="80%" alt="Opening Web Portal in Browser"/><br />
<img src="https://i.imgur.com/dRoQcKT.png" height="80%" width="80%" alt="Dashboard"/><br /><br />

<h4>Creating a <i>Vulnerable</i> Virtual Machine</h4>

Now, I need to create a vulnerable virtual machine in Azure. I go back to Azure portal and create a new virtual machine with the following configurations:<br />
<b>Resource Group</b>: "Vulnerability-Management" -><i>Same as the OpenVAS resource group</i><br />
<b>Virtual machine name</b>: "Windows10-Vulnerable"<br />
<b>Region</b>: "East US 2" -> <i>Same as the OpenVAS VM</i><br />
<b>Image</b>: "Windows 10 Pro, version 22H2 - x64 Gen2"<br />
<b>Size</b>: "Standard_E2s_v3 - 2 vcpus, 16GiB memory" -> <i>I selected the cheapest one with at least 2 Virtual CPUs</i><br />
<b>Username</b></n>: "cybersuhanlab"<br />

<img src="https://i.imgur.com/57JbSx4.png" height="80%" width="80%" alt="VM Settings Vulnerable"/><br /><br />

Next, I go into Network settings and make sure that the Virtual Network is the same one as I used for the OpenVAS. I just clicked Review and Create and Created a new VM.<br />
<img src="https://i.imgur.com/4jBlAqP.png" height="80%" width="80%" alt="Vulnerable VM Network"/><br /><br />

After the Virtual Machine is created, I will go to the Windows10-Vulnerable VM page in Azure Portal to copy the Public IP Address of the VM. This IP Address will be used for Remote Connection to the Windows10-Vulnerable VM. I enter the Username and Password I created while configuring the VM.<br />
<img src="https://i.imgur.com/A6Wj4Jc.png" height="80%" width="80%" alt="Vulnerable VM Network"/><br />
<img src="https://i.imgur.com/pjDOYp6.png" height="80%" width="80%" alt="Vulnerable VM Network"/><br /><br />

Now That I am logged into the VM, I want to make it vulnerable. To do that, I take the following steps:<br />

1. Disable the Firewall<br />
2. Install old versions of software:<br />
   - Adobe Reader<br />
   - Firefox<br />
   - VLC Player<br />
3. Restart the VM<br />

<img src="https://i.imgur.com/vX36vHj.png" height="80%" width="80%" alt="Vulnerable VM Network"/><br />
<img src="https://i.imgur.com/366IzK7.png" height="80%" width="80%" alt="Vulnerable VM Network"/><br />
<img src="https://i.imgur.com/o6RYpS6.png" height="80%" width="80%" alt="Vulnerable VM Network"/><br />
<img src="https://i.imgur.com/WvDxDkw.png" height="80%" width="80%" alt="Vulnerable VM Network"/><br /><br />

<b><i>At this point, The Windows 10 Machine is Vulnerable and ready to be scanned.</i></b>

<h4>Configure OpenVAS and perform First Unauthenticated Scan</h4>
<i>The Unauthenticated Scan means that the OpenVAS will not log on to the vulnerable machine and scan it from a superficial level. I will first do the unauthenticated scan before doing the authenticated scan for comparison.</i> <br />

To start, I log in to the OpenVAS web portal in an <b>Incognito/Private</b> Window. <br />
<img src="https://i.imgur.com/WvDxDkw.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br /><br />

I go to Assets -> Hosts to get to the Hosts page. I click on the "Add New Host" icon. I find the private IP Address of the Windows10-Vulnerable VM and use it in the OpenVAS New host creation window: <br />
<img src="https://i.imgur.com/zDwRJOr.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br />
<img src="https://i.imgur.com/7aWAOK9.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br />
<img src="https://i.imgur.com/dDoS6X5.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br /><br />

The next thing that I do is create a new target from the host. I name the target as Azure Win10 Vulnerable VM. <br />
<img src="https://i.imgur.com/OQmymyg.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br />
<img src="https://i.imgur.com/Wvtmn5G.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br /><br />

Now, I need to create a new task for the scan. So, I go into Scans -> Tasks. Then I create a new task. I name the task as "Scan-Azure-Win10Vulnerable and select the "Azure Win10 Vulnerable VM" as Scan Target which I just created. <br />

<img src="https://i.imgur.com/sydE78f.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br />
<img src="https://i.imgur.com/m6gXyTv.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br />
<img src="https://i.imgur.com/2pFOC27.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br /><br />

I will now start scanning with the little <i>Play</i> button.<br />
<img src="https://i.imgur.com/iV88u9H.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br /><br />

After the scan is complete, I click on the Date of the Last Report column. <br />

<img src="https://i.imgur.com/4mTUj3w.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br /><br />

The scan report has different tabs. The results tab shows the different vulnerabilities found. I don't see any installed software here because this scan was an unauthenticated scan. I expect to see more vulnerabilities when I start an authenticated scan.<br />
<img src="https://i.imgur.com/XfaiozB.png" height="80%" width="80%" alt="Vulnerable VM in incognito"/><br /><br />

In the unauthenticated scan report, The scanner cannot log in and get the full details of vulnerabilities and has a limited capacity for identifying vulnerabilities. <br /><br />

<h4>Running an Authenticated Scan</h4>
To start an authenticated scan, I have to make some configuration modifications first. 











<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
